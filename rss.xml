<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[TobiasMadsen.com]]></title><description><![CDATA[A blog about statistics, software development and mathematics]]></description><link>https://tobiasmadsen.com</link><generator>RSS for Node</generator><lastBuildDate>Thu, 01 Nov 2018 18:09:38 GMT</lastBuildDate><item><title><![CDATA[Lottery tickets to Danish Schools]]></title><description><![CDATA[Follow up on the school story.
Asked DR to share their data. The ministry claims that 400 students were improved as a result of the school…]]></description><link>https://tobiasmadsen.com/winning-the-school-lottery/</link><guid isPermaLink="false">https://tobiasmadsen.com/winning-the-school-lottery/</guid><pubDate>Wed, 31 Oct 2018 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Follow up on the school story.
Asked DR to share their data.&lt;/p&gt;
&lt;p&gt;The ministry claims that 400 students were improved as a result of the school initiative.&lt;/p&gt;
&lt;p&gt;Last week the weekly magazine Weekend Avisen brought a story on the first year results of a governmental initiative to incentivise danish schools with poor academic performance&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.
A schools performance is measured by the percentage of graduating students who get at least a ‘D’ (4) in both danish and mathematics&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;.
By that measure the 121 schools that performed the worst over the last 3 years were eligible to be part of the initiative.
If a school is able to improve by 5 percentage points the first year it will receive a bonus between 1.3 and 1.5 M DKK. &lt;/p&gt;
&lt;p&gt;The angle in Weekend Avisen was that the government had it sound like they would spend around 160 M DKK on the initiative, but with only a little more than half the schools improving sufficiently, that amount dwindled to 90 M DKK.
Here I will focus on another angle, which is briefly touched upon in the article, namely the rocky statistical basis the bonus relies on.&lt;/p&gt;
&lt;p&gt;Most schools have between 20 and 60 students graduating each year.
This means a single student by herself can have an impact of up to 5 percentage point, obviously this leaves a lot of room for random chance.
Furthermore the schools in the initiative are selected for having performed poorly over the last three years. In order to estimate the chance of the schools making their target by random chance we must account for the &lt;a href=&quot;https://en.wikipedia.org/wiki/Regression_toward_the_mean&quot;&gt;regression towards mean&lt;/a&gt; (RTM) effect&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;.
In short regression towards mean is an effect that dictates that if we have just seen an extreme observation the next observation is more likely to be closer to the average: If you throw a die and it comes up 1, there is a great chance that the next throw will be higher than 1.
RTM is strongest when the outcome is highly stochastic and the first observation was very extreme.
For the schools in the initiative, this means that small schools&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; and schools with a poor baseline, have the greatest chance of making the target just by chance. &lt;/p&gt;
&lt;p&gt;Without further ado; here is the list of schools and the probability that they will make their target performance by random chance.
The expected number of schools that make the target without implementing any changes is 43, without accounting for RTM we would underestimated this number to 29.&lt;/p&gt;
&lt;table class=&quot;table&quot; style=&quot;margin-left: auto; margin-right: auto;&quot;&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; School &lt;/th&gt;
   &lt;th style=&quot;text-align:right;&quot;&gt; Approximate number of graduating students &lt;/th&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; Percentage of &quot;weak students&quot; the last 3 years &lt;/th&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; Probability of making the target by chance &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Lindeskovskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 21 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 50 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 53.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dalmose skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 18 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 54 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 52.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Firkløverskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 15 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hanstholm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 25 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Maribo Skole - Borgerskoleafdelingen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 25 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Arenaskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 31 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 62 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Eskilstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 30 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 45 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Stubbekøbing Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 27 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tovshøjskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 25 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 61 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordvestskolen, Ravnsborg afdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 22 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; H. C. Andersen Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 32 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 61 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tingbjerg heldagsskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 46 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 60 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gadehaveskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 60 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Særslev-Hårslev-Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 28 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Læssøesgades Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Grønhøjskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 41 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 52 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skælskør Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 41 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Svend Gønge-Skolen, Lundby &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 48 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Lille Næstved Skole, afd. Fuglebjerg &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 33 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Møn Skole, Stege &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 39 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sydfalster Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 26 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tagensbo Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 50 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 60 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Abildgårdskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 45 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 55 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Blågård Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 56 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 59 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Søndre Skole, Rødby &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 39 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 50 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hirtshals undervisningssted &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 49 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 48 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Mørkhøj Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 40 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Midtskolen, Sofiendal afdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 42 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Brændgårdskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 34 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Marienhoffskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 38 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Rådmandsgades Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 62 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 57 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Amagerskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 35 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Vejlebroskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 42 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ikast Vestre Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 41 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skærbæk Distriktsskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 53 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 45 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ålholm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 56 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nysted Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 40 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Åboulevarden &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 27 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Høje Kolstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 45 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Strandgårdskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 50 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Urbanskolen, Urban P &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen i Midten &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 24 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ullerup Bæk Skolen, Nr. Alle &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 38 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Signaturskolen, Kvaglund &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ulstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nørreskov-Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Kolind Centralskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Vejle Midtbyskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 57 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Baltorpskolen - Rugvænget &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 48 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dalumskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 56 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nymarkskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 51 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Korsvejens Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 47 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Toftegårdsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 30 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Baltorpskolen - Grantoften &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 55 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 48 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nørrevangsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 55 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 54 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nr Alslev Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Vesterbro Ny Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 75 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 52 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Brædstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Breum Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 26 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gildbroskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 52 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Roslev Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 34 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Frederiksværk skole, Enghave &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordskolen - afdeling Højby &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 42 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distriktsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 43 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ejerslykkeskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 53 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Herstedlund Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Seden Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Kirstinebjergskolen, Havepladsvej &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 45 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Avedøre Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 67 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nørrebro Park Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 72 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 53 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skovvangskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 47 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordals skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 38 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordvestskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hannæs-Østerild Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 29 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hendriksholm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 64 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Charlotteskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 43 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Engstrandskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 56 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sct. Jørgens Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hammerum Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Langmarkskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 52 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; NOVAskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 47 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ulkebøl Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Birkhovedskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 48 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Munkebo Skole - mellem nor og fjord &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ørum Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 62 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Farsø Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 69 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Risingskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 74 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Højmarkskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 55 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen ved Rønnebær Allé &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 49 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Arresø Skole, Magleblik &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 65 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen ved Gurrevej &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gungehusskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Thorning Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 39 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Glostrup Skole, Skovvang &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 51 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ikast Østre Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 68 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dagnæsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 54 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gribskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 57 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Østerbyskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 57 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Mølleholmskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 76 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Seminarieskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 46 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sønderskov-Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 68 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distrikt Nord, Skagen skoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tungelundskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Herlev byskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 84 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Borgerskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 78 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hasle Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 61 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Herstedvester Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 93 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Søndervangskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 103 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen ved Bulowsvej &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 92 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sophieskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 81 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Rønneskolen, afdeling Åvang &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 74 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 25.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Bakkegårdsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 76 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 25.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sofiendalskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 64 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 25.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Horsens Byskole, folkeskoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 106 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 50 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 24.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tarm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 62 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 24.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Brøndby Strand Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 104 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 23.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tingstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 22.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Auning Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 74 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 21.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dueholmskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 91 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 21.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distrikt Øst, Nordstjernenskoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 92 &lt;/td&gt;
   &lt;td style=&quot;text-lign:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 19.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distrikt Øst, Frydenstrandskoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 79 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 19.1 % &lt;/td&gt;
  &lt;/tr&gt;
  
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://www.weekendavisen.dk/2018-30/samfund/karakterer-for-millioner&quot;&gt;Karakterer for millioner&lt;/a&gt;&lt;/p&gt;
&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;
&lt;p&gt;The Ministry of Education seems to &lt;a href=&quot;https://uvm.dk/aktuelt/nyheder/uvm/2017/april/170425-500-mio--kr--til-loeft-af-fagligt-svage-elever&quot;&gt;think&lt;/a&gt; that the negation of getting at least 4 in both Danish and Mathematics is getting less than 4 in both Danish and Mathematics. At one place the hope is to reduce the percentage of students who get less than 4 in Danish and Mathematics (“For at få del i puljen skal skolerne i hvert af de tre år reducere andelen af elever, der får under karakteren 4 i dansk og matematik”) at another place it is the percentage of students who doesn’t get at least 4 in danish and mathematics  (”[…] forstået som andelen af elever, der ikke opnår mindst 4 i dansk og matematik i 9.-klasseprøverne”)&lt;/p&gt;
&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;
&lt;p&gt;I assume that each school has an inherent probability that a graduating student will get at least 4 in danish and mathematics. The prior distribution for this probability is modelled by a beta distribution. The parameters of this distribution is chosen such that the mean is .22 (the national average) and the probability of being larger than .41 is 0.0431 (I assume all schools performing worse than .41 are part of the initiative). The posterior distribution for each school is again a beta distribution calculated from the baseline performance and the number of students graduating in 3 years.&lt;/p&gt;
&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;
&lt;p&gt;The sizes of the schools are approximate and based on &lt;a href=&quot;https://uvm.dk/statistik/grundskolen/elever/elevtal-i-grundskolen&quot;&gt;this&lt;/a&gt; list of school sizes supplemented with information from individual schools websites.&lt;/p&gt;
&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Lottery tickets to Danish Schools]]></title><description><![CDATA[Last week the weekly magazine Weekend Avisen brought a story on the first year results of a governmental initiative to incentivise danish…]]></description><link>https://tobiasmadsen.com/lottery-tickets-to-danish-schools/</link><guid isPermaLink="false">https://tobiasmadsen.com/lottery-tickets-to-danish-schools/</guid><pubDate>Fri, 10 Aug 2018 22:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Last week the weekly magazine Weekend Avisen brought a story on the first year results of a governmental initiative to incentivise danish schools with poor academic performance&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.
A schools performance is measured by the percentage of graduating students who get at least a ‘D’ (4) in both danish and mathematics&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;.
By that measure the 121 schools that performed the worst over the last 3 years were eligible to be part of the initiative.
If a school is able to improve by 5 percentage points the first year it will receive a bonus between 1.3 and 1.5 M DKK. &lt;/p&gt;
&lt;p&gt;The angle in Weekend Avisen was that the government had it sound like they would spend around 160 M DKK on the initiative, but with only a little more than half the schools improving sufficiently, that amount dwindled to 90 M DKK.
Here I will focus on another angle, which is briefly touched upon in the article, namely the rocky statistical basis the bonus relies on.&lt;/p&gt;
&lt;p&gt;Most schools have between 20 and 60 students graduating each year.
This means a single student by herself can have an impact of up to 5 percentage point, obviously this leaves a lot of room for random chance.
Furthermore the schools in the initiative are selected for having performed poorly over the last three years. In order to estimate the chance of the schools making their target by random chance we must account for the &lt;a href=&quot;https://en.wikipedia.org/wiki/Regression_toward_the_mean&quot;&gt;regression towards mean&lt;/a&gt; (RTM) effect&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;.
In short regression towards mean is an effect that dictates that if we have just seen an extreme observation the next observation is more likely to be closer to the average: If you throw a die and it comes up 1, there is a great chance that the next throw will be higher than 1.
RTM is strongest when the outcome is highly stochastic and the first observation was very extreme.
For the schools in the initiative, this means that small schools&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; and schools with a poor baseline, have the greatest chance of making the target just by chance. &lt;/p&gt;
&lt;p&gt;Without further ado; here is the list of schools and the probability that they will make their target performance by random chance.
The expected number of schools that make the target without implementing any changes is 43, without accounting for RTM we would underestimated this number to 29.&lt;/p&gt;
&lt;table class=&quot;table&quot; style=&quot;margin-left: auto; margin-right: auto;&quot;&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; School &lt;/th&gt;
   &lt;th style=&quot;text-align:right;&quot;&gt; Approximate number of graduating students &lt;/th&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; Percentage of &quot;weak students&quot; the last 3 years &lt;/th&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; Probability of making the target by chance &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Lindeskovskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 21 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 50 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 53.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dalmose skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 18 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 54 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 52.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Firkløverskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 15 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hanstholm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 25 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Maribo Skole - Borgerskoleafdelingen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 25 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Arenaskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 31 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 62 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Eskilstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 30 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 45 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 51.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Stubbekøbing Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 27 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tovshøjskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 25 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 61 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordvestskolen, Ravnsborg afdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 22 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 49.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; H. C. Andersen Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 32 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 61 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tingbjerg heldagsskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 46 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 60 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gadehaveskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 60 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Særslev-Hårslev-Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 28 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Læssøesgades Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Grønhøjskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 41 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 52 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skælskør Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 41 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Svend Gønge-Skolen, Lundby &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 48 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Lille Næstved Skole, afd. Fuglebjerg &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 33 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Møn Skole, Stege &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 39 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sydfalster Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 26 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tagensbo Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 50 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 60 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Abildgårdskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 45 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 55 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Blågård Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 56 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 59 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Søndre Skole, Rødby &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 39 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 50 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hirtshals undervisningssted &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 49 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 48 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Mørkhøj Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 40 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Midtskolen, Sofiendal afdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 42 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Brændgårdskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 34 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Marienhoffskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 38 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Rådmandsgades Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 62 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 57 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Amagerskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 35 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 44 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Vejlebroskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 42 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ikast Vestre Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 41 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skærbæk Distriktsskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 53 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 45 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ålholm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 56 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nysted Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 40 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Åboulevarden &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 27 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Høje Kolstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 45 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Strandgårdskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 50 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Urbanskolen, Urban P &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen i Midten &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 24 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ullerup Bæk Skolen, Nr. Alle &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 38 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Signaturskolen, Kvaglund &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ulstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nørreskov-Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Kolind Centralskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Vejle Midtbyskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 57 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Baltorpskolen - Rugvænget &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 48 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dalumskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 56 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nymarkskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 51 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Korsvejens Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 47 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Toftegårdsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 30 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Baltorpskolen - Grantoften &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 55 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 48 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nørrevangsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 55 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 54 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nr Alslev Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Vesterbro Ny Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 75 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 52 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Brædstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Breum Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 26 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gildbroskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 52 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Roslev Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 34 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Frederiksværk skole, Enghave &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordskolen - afdeling Højby &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 42 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distriktsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 43 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ejerslykkeskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 53 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 42 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Herstedlund Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Seden Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 46 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Kirstinebjergskolen, Havepladsvej &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 45 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Avedøre Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 67 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nørrebro Park Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 72 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 53 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skovvangskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 47 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordals skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 38 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Nordvestskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 36 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hannæs-Østerild Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 29 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hendriksholm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 64 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Charlotteskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 43 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Engstrandskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 56 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sct. Jørgens Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hammerum Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Langmarkskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 52 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 37 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; NOVAskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 47 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ulkebøl Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Birkhovedskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 48 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Munkebo Skole - mellem nor og fjord &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ørum Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 62 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Farsø Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 69 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Risingskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 74 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Højmarkskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 55 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen ved Rønnebær Allé &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 49 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Arresø Skole, Magleblik &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 65 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen ved Gurrevej &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gungehusskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 60 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Thorning Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 39 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 30 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Glostrup Skole, Skovvang &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 51 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.4 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Ikast Østre Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 68 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dagnæsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 54 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Gribskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 57 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Østerbyskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 57 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 38 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Mølleholmskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 76 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Seminarieskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 46 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 33 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sønderskov-Skolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 68 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 35 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distrikt Nord, Skagen skoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 44 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 28.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tungelundskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 37 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Herlev byskole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 84 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 36 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27.7 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Borgerskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 78 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Hasle Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 61 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 27 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Herstedvester Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 93 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Søndervangskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 103 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 47 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Skolen ved Bulowsvej &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 92 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sophieskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 81 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 43 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 26.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Rønneskolen, afdeling Åvang &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 74 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 40 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 25.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Bakkegårdsskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 76 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 39 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 25.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Sofiendalskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 64 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 31 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 25.1 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Horsens Byskole, folkeskoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 106 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 50 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 24.8 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tarm Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 62 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 34 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 24.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Brøndby Strand Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 104 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 41 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 23.6 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Tingstrup Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 58 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 22.9 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Auning Skole &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 74 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 21.3 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Dueholmskolen &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 91 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 21.2 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distrikt Øst, Nordstjernenskoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 92 &lt;/td&gt;
   &lt;td style=&quot;text-lign:left;&quot;&gt; 32 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 19.5 % &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; Distrikt Øst, Frydenstrandskoleafdeling &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 79 &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 29 % &lt;/td&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 19.1 % &lt;/td&gt;
  &lt;/tr&gt;
  
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://www.weekendavisen.dk/2018-30/samfund/karakterer-for-millioner&quot;&gt;Karakterer for millioner&lt;/a&gt;&lt;/p&gt;
&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;
&lt;p&gt;The Ministry of Education seems to &lt;a href=&quot;https://uvm.dk/aktuelt/nyheder/uvm/2017/april/170425-500-mio--kr--til-loeft-af-fagligt-svage-elever&quot;&gt;think&lt;/a&gt; that the negation of getting at least 4 in both Danish and Mathematics is getting less than 4 in both Danish and Mathematics. At one place the hope is to reduce the percentage of students who get less than 4 in Danish and Mathematics (“For at få del i puljen skal skolerne i hvert af de tre år reducere andelen af elever, der får under karakteren 4 i dansk og matematik”) at another place it is the percentage of students who doesn’t get at least 4 in danish and mathematics  (”[…] forstået som andelen af elever, der ikke opnår mindst 4 i dansk og matematik i 9.-klasseprøverne”)&lt;/p&gt;
&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;
&lt;p&gt;I assume that each school has an inherent probability that a graduating student will get at least 4 in danish and mathematics. The prior distribution for this probability is modelled by a beta distribution. The parameters of this distribution is chosen such that the mean is .22 (the national average) and the probability of being larger than .41 is 0.0431 (I assume all schools performing worse than .41 are part of the initiative). The posterior distribution for each school is again a beta distribution calculated from the baseline performance and the number of students graduating in 3 years.&lt;/p&gt;
&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;
&lt;p&gt;The sizes of the schools are approximate and based on &lt;a href=&quot;https://uvm.dk/statistik/grundskolen/elever/elevtal-i-grundskolen&quot;&gt;this&lt;/a&gt; list of school sizes supplemented with information from individual schools websites.&lt;/p&gt;
&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[P-values and Posterior Probabilities]]></title><description><![CDATA[You might want to argue that the question in the subtitle is based on a false premise; 
the p-value is related to the probability of falsely…]]></description><link>https://tobiasmadsen.com/p_values_and_posterior_probabilities/</link><guid isPermaLink="false">https://tobiasmadsen.com/p_values_and_posterior_probabilities/</guid><pubDate>Sun, 09 Apr 2017 22:00:00 GMT</pubDate><content:encoded>&lt;p&gt;You might want to argue that the question in the subtitle is based on a false premise;
the p-value is related to the probability of falsely rejecting the null hypothesis conditional on the level (&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\alpha&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;) and the null hypothesis being true.
The question of whether the null-model valid or not is only assessed from this viewpoint and we certainly cannot assign a probability it. &lt;/p&gt;
&lt;p&gt;However in Bayesian statistics such a question is perfectly valid.
The theory of Bayesian robustness examines how sensitive a Bayesian inference is to the choice of prior.
Thereby addressing one of the main criticisms of Bayesian statistics.
In a seminal &lt;a href=&quot;http://www.jstor.org/stable/2289131&quot;&gt;paper&lt;/a&gt;, James O. Berger and Thomas Sellke consider a single realization (the results still holds for multiple realizations) of a normal variable with known variance:&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;∼&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;script&quot;&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;X \sim \mathcal{N}(\theta, 1)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∼&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathcal&quot; style=&quot;margin-right:0.14736em;&quot;&gt;N&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;and a test for the hypothesis&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;M_0: \theta = 0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.84444em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;against the alternative&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mo&gt;≠&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;.&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;M_1: \theta \neq 0.&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.716em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.9309999999999999em;vertical-align:-0.215em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;≠&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;Let’s also phrase a Bayesian model; we give each of the two models an equal prior probability
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;.&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;P(M_0)=\frac{1}{2}.&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.845108em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1.190108em;vertical-align:-0.345em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.13889em;&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.845108em;&quot;&gt;&lt;span style=&quot;top:-2.6550000000000002em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.394em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.345em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
We also need a prior for &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\theta&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; under &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;M_1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;g(\theta)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Berger and Sellke shows that if &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;|X| &amp;gt; 1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; corresponding to a p-value less than 0.32, the prior favoring &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;M_1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.10903em;&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; the most within the class of symmetric unimodal distributions is a uniform distribution,&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mspace width=&quot;0.16667em&quot;&gt;&lt;/mspace&gt;&lt;mspace width=&quot;0.16667em&quot;&gt;&lt;/mspace&gt;&lt;mspace width=&quot;0.16667em&quot;&gt;&lt;/mspace&gt;&lt;mi&gt;θ&lt;/mi&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;g(\theta) = \frac{1}{2K},\,\,\, \theta \in [-K, K]&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.32144em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:2.00744em;vertical-align:-0.686em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;g&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.32144em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace thinspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace thinspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace thinspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02778em;&quot;&gt;θ&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;∈&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;We find the &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;K&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.68333em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; that maximizes the posterior probability of the alternative for different values of &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;X&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.68333em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07847em;&quot;&gt;X&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; and their corresponding posterior probabilities and p-values. &lt;/p&gt;
&lt;table class=&quot;table&quot; style=&quot;margin-left: auto; margin-right: auto; align: center; width: 60%; font-size: 1.3rem&quot;&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style=&quot;text-align:left;&quot;&gt; P-value&lt;/th&gt;
   &lt;th style=&quot;text-align:right;&quot;&gt; Posterior of H0 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 0.100&lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 0.3895459 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 0.050 &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 0.2904357 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 0.010 &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 0.1094489 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style=&quot;text-align:left;&quot;&gt; 0.001 &lt;/td&gt;
   &lt;td style=&quot;text-align:right;&quot;&gt; 0.0177166 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This answers our question: With the prior that &lt;em&gt;favors the alternative the most&lt;/em&gt; the posterior probability that the null hypothesis is true for a p-value of 0.045 is still 0.28. Not exactly overwhelming evidence for the alternative.&lt;/p&gt;
&lt;p&gt;Below we have plotted the posterior probability for &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;H_0&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.83333em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.08125em;&quot;&gt;H&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; against the p-value for the prior that favors the alternative the most.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5846543219e0228b1c99e93c2109692c/58f8a/p-value-posterior.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 71.42857142857143%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABAklEQVQ4y5WT6QrEIAyEff8Hbfuz9L6z+wkjWZFuKwTN4TgTNRzHYeM42rIstm2brev6yKjd9z2up2myvu9tnmcL9h0kr+syP/75gAEEGQwfckFJHDbJzvP8mRmsYTEMQzSIEPOHBIA4KQfwQMySpVrFfW0EJEEfFPRFynVdF5l52Xl9AoQ6LHPJGL0h75neWQSs6zresAfkdFgRF1CpJTnLCNg0TboUbQYMqV5aSWKRIYWSzKDx3F4u8TEgC6TpJrFS018x1C+BXd6fu7nYQ7EBjED+M+7m0u8JksoToY8EZfKZxcjHtZbPRQa9Nxgqify2bdMG/Kqq0qGYHrt8chD7AChCUM2ZJym8AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;plot of chunk unnamed-chunk-3&quot;
        title=&quot;&quot;
        src=&quot;/static/5846543219e0228b1c99e93c2109692c/fb8a0/p-value-posterior.png&quot;
        srcset=&quot;/static/5846543219e0228b1c99e93c2109692c/1a291/p-value-posterior.png 148w,
/static/5846543219e0228b1c99e93c2109692c/2bc4a/p-value-posterior.png 295w,
/static/5846543219e0228b1c99e93c2109692c/fb8a0/p-value-posterior.png 590w,
/static/5846543219e0228b1c99e93c2109692c/526de/p-value-posterior.png 885w,
/static/5846543219e0228b1c99e93c2109692c/fa2eb/p-value-posterior.png 1180w,
/static/5846543219e0228b1c99e93c2109692c/58f8a/p-value-posterior.png 1344w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Automatic Differentiation in R]]></title><description><![CDATA[Automatic Differentiation (AD) specifically reverse-mode AD takes a function, 
  
defined by a computer program and computes the gradient…]]></description><link>https://tobiasmadsen.com/automatic_differentiation_in_r/</link><guid isPermaLink="false">https://tobiasmadsen.com/automatic_differentiation_in_r/</guid><pubDate>Thu, 30 Mar 2017 22:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Automatic Differentiation (AD) specifically reverse-mode AD takes a function,
&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;f: \mathbb{R}^n\rightarrow\mathbb{R},&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.8888799999999999em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.10764em;&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathbb&quot;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.664392em;&quot;&gt;&lt;span style=&quot;top:-3.063em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;n&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;→&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathbb&quot;&gt;R&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
defined by a computer program and computes the gradient exactly (up to machine precision) and at the same time complexity as the original program.
Here I will show how one can use the Reverse-Mode Automatic Differentiation Library provided by &lt;a href=&quot;https://arxiv.org/abs/1509.07164&quot;&gt;Stan Math Library&lt;/a&gt; in R. &lt;/p&gt;
&lt;h4&gt;Setting Up&lt;/h4&gt;
&lt;p&gt;The hardest part is making sure that dependencies are resolved during compilation.
The relevant headers are in the &lt;code class=&quot;language-text&quot;&gt;Rcpp&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;RcppEigen&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;StanHeaders&lt;/code&gt; packages, so first these packages must be installed:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre style=&quot;counter-reset: linenumber 0&quot; class=&quot;language-r line-numbers&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;install.packages&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Rcpp&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;RcppEigen&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;StanHeaders&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/code&gt;&lt;span aria-hidden=&quot;true&quot; class=&quot;line-numbers-rows&quot; style=&quot;white-space: normal; width: auto; left: 0;&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The headers must be included during compilation, to this end we set &lt;code class=&quot;language-text&quot;&gt;PKG_CXXFLAGS&lt;/code&gt; system variable.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;Sys.setenv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;PKG_CXXFLAGS&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;-I&quot;YOUR_LIB_PATH/Rcpp/include&quot; -I&quot;YOUR_LIB_PATH/RcppEigen/include&quot; -I&quot;YOUR_LIB_PATH/StanHeaders/include&quot;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Where &lt;code class=&quot;language-text&quot;&gt;YOUR_LIB_PATH&lt;/code&gt; should be replaced with the directory where R packages are installed on your system, which can be found by calling &lt;code class=&quot;language-text&quot;&gt;.libPaths()&lt;/code&gt;.
Note that if you are developing a package it is enough to add the following line to the &lt;code class=&quot;language-text&quot;&gt;DESCRIPTION&lt;/code&gt; file:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;LinkingTo&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; Rcpp &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.12&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; RcppEigen&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; StanHeaders &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.12&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Reverse-Mode AD&lt;/h4&gt;
&lt;p&gt;Now we are ready to see AD in action. The following function computes the log density function of a normal distrubted variable &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mi&gt;ϕ&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;;&lt;/mo&gt;&lt;mi&gt;μ&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;σ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\log \phi(y; \mu, \sigma)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;ϕ&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;μ&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;σ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, and its derivative with respect to &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;μ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;y,\mu&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.625em;vertical-align:-0.19444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;μ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; and &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;σ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\sigma&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;σ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;#&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Rcpp.h&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;#&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;stan/math.hpp&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; Rcpp&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// [[Rcpp::export]]&lt;/span&gt;
NumericVector &lt;span class=&quot;token function&quot;&gt;normLogLikAD&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; y_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; mu_&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; sigma_&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  NumericVector &lt;span class=&quot;token function&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  stan&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;math&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;var y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; y_&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  stan&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;math&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;var mu &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mu_&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  stan&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;math&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;var sigma &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sigma_&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  stan&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;math&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;var lp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  lp &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;mu&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;sigma&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;mu&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;sigma&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sigma&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;PI&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Compute Function Value&lt;/span&gt;
  ret&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;val&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Compute Gradient&lt;/span&gt;
  lp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;grad&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  ret&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;adj&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  ret&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mu&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;adj&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  ret&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sigma&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;adj&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Memory is allocated on a global stack&lt;/span&gt;
  stan&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;math&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;recover_memory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  stan&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;math&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;ChainableStack&lt;span class=&quot;token operator&quot;&gt;::&lt;/span&gt;memalloc_&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;free_all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; ret&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The function is now callable from R.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;normLogLikAD&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;## [1] -1.737086  0.250000 -0.250000 -0.375000&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Compare this with the gradient found using numerical differentiation:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;library&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;numDeriv&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
grad&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;func &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;par&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;dnorm&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;par&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;par&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;par&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; log&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;## [1]  0.250 -0.250 -0.375&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;C++&lt;/code&gt; code is mostly straightforward: Variables are declared as &lt;code class=&quot;language-text&quot;&gt;stan::math::var&lt;/code&gt; all other variables are treated as constants.
To compute the actual value of a variable we call the member-function &lt;code class=&quot;language-text&quot;&gt;val()&lt;/code&gt;,
to compute the gradient of a variable &lt;code class=&quot;language-text&quot;&gt;y&lt;/code&gt; with respect to some variables &lt;code class=&quot;language-text&quot;&gt;x1,x2&lt;/code&gt; we call &lt;code class=&quot;language-text&quot;&gt;y&lt;/code&gt;’s member function &lt;code class=&quot;language-text&quot;&gt;grad()&lt;/code&gt;,
and the partial derivative &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∂&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\frac{\partial y}{\partial x_1}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.9322159999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1.377316em;vertical-align:-0.44509999999999994em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.9322159999999999em;&quot;&gt;&lt;span style=&quot;top:-2.655em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31731428571428577em;&quot;&gt;&lt;span style=&quot;top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.5em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size3 size1 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.143em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.446108em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot; style=&quot;margin-right:0.05556em;&quot;&gt;∂&lt;/span&gt;&lt;span class=&quot;mord mathit mtight&quot; style=&quot;margin-right:0.03588em;&quot;&gt;y&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.44509999999999994em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; can be obtained by calling &lt;code class=&quot;language-text&quot;&gt;x1&lt;/code&gt;’s member function &lt;code class=&quot;language-text&quot;&gt;adj()&lt;/code&gt;.
Finally it should be noted that &lt;code class=&quot;language-text&quot;&gt;stan::math&lt;/code&gt; allocates memory for variables on a global stack,
that means memory is not automatically freed up when the variables goes out of scope.
The function &lt;code class=&quot;language-text&quot;&gt;recover_memory()&lt;/code&gt; clears this stack and &lt;code class=&quot;language-text&quot;&gt;ChainableStack::memalloc_.free_all()&lt;/code&gt; frees the memory associated with it,
both should be called after finish computation.&lt;/p&gt;
&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://arxiv.org/abs/1509.07164&quot;&gt;Stan Math Library&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Significance Evaluation in Factor Graphs]]></title><description><![CDATA[Our paper on  Significance Evaluation in Factor Graphs  has just been published.
In the paper we investigate how to evaluate the…]]></description><link>https://tobiasmadsen.com/Significance-Evaluation-in-Factor-Graphs/</link><guid isPermaLink="false">https://tobiasmadsen.com/Significance-Evaluation-in-Factor-Graphs/</guid><pubDate>Thu, 30 Mar 2017 22:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Our paper on &lt;a href=&quot;http://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1614-z&quot;&gt;Significance Evaluation in Factor Graphs&lt;/a&gt; has just been published.
In the paper we investigate how to evaluate the significance of rare events for a wide-class of models defined by factor graphs. Factor graphs are a graphical model formalism capturing both Bayesian Networks and Markov Random Fields and thus covering a very wide range of models.
Originally we were led to this question by considering relatively simple first and second order Markov chain models for long DNA motifs, exhibiting dependencies between neighboring bases. Particularly we were looking at the nucleosome binding motif.
While developing our methods a great &lt;a href=&quot;https://academic.oup.com/nar/article/44/13/6055/2457621/Bayesian-Markov-models-consistently-outperform&quot;&gt;paper&lt;/a&gt; on learning these neighbor correlations between bases in motifs in a regularized fashion was published. This makes me quite confident that our methods are relevant to the field.
Without further ado - enjoy &lt;a href=&quot;http://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-017-1614-z&quot;&gt;reading&lt;/a&gt;.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[MySQL queries in UCSC databases]]></title><description><![CDATA[I recently wanted to retrieve all SNP’s from  dbSNP  overlapping a set of regions using  UCSC’s MySQL interface .
This post shows you how…]]></description><link>https://tobiasmadsen.com/mysql-queries-in-ucsc-databases/</link><guid isPermaLink="false">https://tobiasmadsen.com/mysql-queries-in-ucsc-databases/</guid><pubDate>Fri, 20 Nov 2015 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;I recently wanted to retrieve all SNP’s from &lt;a href=&quot;https://genome.ucsc.edu/cgi-bin/hgTables?db=hg38&amp;#x26;hgta_group=varRep&amp;#x26;hgta_track=snp142Common&amp;#x26;hgta_table=snp142Common&amp;#x26;hgta_doSchema=describe+table+schema&quot;&gt;dbSNP&lt;/a&gt; overlapping a set of regions using &lt;a href=&quot;https://genome.ucsc.edu/goldenPath/help/mysql.html&quot;&gt;UCSC’s MySQL interface&lt;/a&gt;.
This post shows you how this can be done and how to increase the speed of queries by using UCSC’s binning scheme.&lt;/p&gt;
&lt;p&gt;First things first - we connect to the database:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;library&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_db &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; src_mysql&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hg19&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                   host &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;genome-mysql.cse.ucsc.edu&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                   user &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;genomep&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                   password &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;password&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
snpDbMySQL &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; tbl&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_db&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;snp142&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we try to retrieve all the SNP’s within a short region of 1kb:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# NOT RUN&lt;/span&gt;
my_snps &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; snpDbMySQL &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chrom &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;chr1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chromStart &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chromEnd &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4001000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  collect&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Taking some 40 seconds this is surprisingly slow. (Notice that no data is actually fetched before the &lt;code class=&quot;language-text&quot;&gt;collect&lt;/code&gt; command, &lt;code class=&quot;language-text&quot;&gt;dplyr&lt;/code&gt; is designed to be as lazy as possible with fetching data, see &lt;code class=&quot;language-text&quot;&gt;dplyr&lt;/code&gt;’s database &lt;a href=&quot;https://cran.r-project.org/web/packages/dplyr/vignettes/databases.html&quot;&gt;vignette&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;Let’s investigate a bit and look at how the table is indexed:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;mysql&amp;gt; SHOW INDEX in hg19.snp142;
+--------+----------+--------------+-------------+
| Table  | Key_name | Seq_in_index | Column_name |
+--------+----------+--------------+-------------+
| snp142 | name     |            1 | name        |
| snp142 | chrom    |            1 | chrom       |
| snp142 | chrom    |            2 | bin         |
+--------+----------+--------------+-------------+
3 rows in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The output of the &lt;code class=&quot;language-text&quot;&gt;SHOW INDEX&lt;/code&gt; MySQL command reveals that the table is indexed after &lt;code class=&quot;language-text&quot;&gt;name&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;chrom&lt;/code&gt; and something called &lt;code class=&quot;language-text&quot;&gt;bin&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It turns out that the binning scheme was described in the original &lt;a href=&quot;http://genome.cshlp.org/content/12/6/996.full&quot;&gt;paper&lt;/a&gt; on the genome browser.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://genome.cshlp.org/content/12/6/996/F7.large.jpg&quot; alt=&quot;Source: Kent, et. al. Genome Research 2002&quot;&gt;&lt;/p&gt;
&lt;p&gt;The bin assigned to a feature is the smallest bin the contains the entire feature. So in the figure the feature A will be assigned to bin 1, feature B to bin 4 and feature C to bin 20. SNP’s will always fall into the lowest order of bins. &lt;/p&gt;
&lt;p&gt;To calculate the bin(s) we need to consider, we can use a slightly modified version of Jim Kent’s C script and use &lt;code class=&quot;language-text&quot;&gt;Rcpp&lt;/code&gt;. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;cpp&quot;&gt;&lt;pre class=&quot;language-cpp&quot;&gt;&lt;code class=&quot;language-cpp&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;#&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&amp;lt;Rcpp.h&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;namespace&lt;/span&gt; Rcpp&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; binOffsets&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// [[Rcpp::export]]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;binFromRangeStandard&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; start&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; end&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; startBin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; start&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; endBin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; end&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  startBin &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  endBin &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startBin &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; endBin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; binOffsets&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; startBin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    startBin &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    endBin &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;library&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Rcpp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
sourceCpp&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;UCSCBinFromRange.cpp&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;binRange &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;binFromRangeStandard&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4000001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; binFromRangeStandard&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4001000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4001001&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;## [1] 615 615&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We see that both the start and the end coordinate falls into bin &lt;code class=&quot;language-text&quot;&gt;615&lt;/code&gt;.
It is now much faster to query for the SNP’s within the region&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;my_snps &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; snpDbMySQL &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chrom &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;chr1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bin &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;615&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chromStart &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chromEnd &lt;span class=&quot;token operator&quot;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4001000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  collect
my_snps &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt; select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;bin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; chrom&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; chromStart&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; chromEnd&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;## Source: local data frame [54 x 4]
## 
##      bin chrom chromStart chromEnd
##    (dbl) (chr)      (dbl)    (dbl)
## 1    615  chr1    4000015  4000016
## 2    615  chr1    4000040  4000041
## 3    615  chr1    4000080  4000081
## 4    615  chr1    4000090  4000091
## 5    615  chr1    4000091  4000092
## 6    615  chr1    4000105  4000106
## 7    615  chr1    4000110  4000111
## 8    615  chr1    4000111  4000112
## 9    615  chr1    4000112  4000113
## 10   615  chr1    4000136  4000137
## ..   ...   ...        ...      ...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And that is it.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[UseR! Talk]]></title><description><![CDATA[I recently attended the UseR! conference in  Aalborg .
It was a great conference with great tutorials, good talks and foremost a lot of…]]></description><link>https://tobiasmadsen.com/useR-talk-2015/</link><guid isPermaLink="false">https://tobiasmadsen.com/useR-talk-2015/</guid><pubDate>Mon, 10 Aug 2015 22:00:00 GMT</pubDate><content:encoded>&lt;p&gt;I recently attended the UseR! conference in &lt;a href=&quot;http://user2015.math.aau.dk/&quot;&gt;Aalborg&lt;/a&gt;.
It was a great conference with great tutorials, good talks and foremost a lot of interesting people.
As I grew up in Aalborg I could not help feeling a bit proud, that the city and the mathematics department pulled this of so brilliantly.
I was lucky enough to get the chance to present my work on the &lt;a href=&quot;http://tobiasmadsen.com/dgRaph/&quot;&gt;dgRaph package&lt;/a&gt;,
the slides from the presentation can be found &lt;a href=&quot;/assets/useR2015/useR.html&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/75f54be5752cf9fce8ce18b3b5b8f153/29eef/useRtalk.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHmNEsS8V//xAAaEAADAAMBAAAAAAAAAAAAAAABAgMAEhMR/9oACAEBAAEFApR6C0eQxDqtDsGRff/EABYRAQEBAAAAAAAAAAAAAAAAAAAREv/aAAgBAwEBPwGMv//EABYRAQEBAAAAAAAAAAAAAAAAAAAREv/aAAgBAgEBPwGtP//EAB4QAAIBAwUAAAAAAAAAAAAAAAARAQMSIRAiMWGC/9oACAEBAAY/Amzl6YrLyZq39Wm2YR//xAAbEAADAAMBAQAAAAAAAAAAAAAAAREhMVFBgf/aAAgBAQABPyFul+DUPc5ogpVX5kPVldQPpNHtP//aAAwDAQACAAMAAAAQPz//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxC1v//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAECAQE/EJQ//8QAGhABAQADAQEAAAAAAAAAAAAAAREAIUExcf/aAAgBAQABPxABW1JtjHXQjmPn5hAaLKh+57nmogpLcWILops3zP/Z&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;Me at useR!&quot;
        title=&quot;&quot;
        src=&quot;/static/75f54be5752cf9fce8ce18b3b5b8f153/f8fb9/useRtalk.jpg&quot;
        srcset=&quot;/static/75f54be5752cf9fce8ce18b3b5b8f153/e8976/useRtalk.jpg 148w,
/static/75f54be5752cf9fce8ce18b3b5b8f153/63df2/useRtalk.jpg 295w,
/static/75f54be5752cf9fce8ce18b3b5b8f153/f8fb9/useRtalk.jpg 590w,
/static/75f54be5752cf9fce8ce18b3b5b8f153/85e3d/useRtalk.jpg 885w,
/static/75f54be5752cf9fce8ce18b3b5b8f153/d1924/useRtalk.jpg 1180w,
/static/75f54be5752cf9fce8ce18b3b5b8f153/29eef/useRtalk.jpg 1632w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Locally Weighted Logistic Regression]]></title><description><![CDATA[Given a male patient 45 years of age and a BMI of 27 how great is the risk of having diabetes? What is the relationship between the chance…]]></description><link>https://tobiasmadsen.com/locally-weighted-logistic-regression/</link><guid isPermaLink="false">https://tobiasmadsen.com/locally-weighted-logistic-regression/</guid><pubDate>Wed, 25 Mar 2015 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Given a male patient 45 years of age and a BMI of 27 how great is the risk of having diabetes? What is the relationship between the chance of wining an election and the campaign budget? How does the probability of playing in NBA increase with height?
A simple way to approach such problems is by looking at similar observations, for instance look at men at ages between 40-50 and a BMI 25-30 and use the frequency of diabetes in this group to infer the risk for our given patient.
Logistic regression is a more sophisticated method. There we model the probability of having diabetes as a function of the covariates of the following form:&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;∑&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;β&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;.&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\log\frac{\pi(\mathbf{x})}{1-\pi(\mathbf{x})} = \beta_0 + \sum_{i=1}^p \beta_ix_i.&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.6985050000000004em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:2.9761740000000003em;vertical-align:-1.277669em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mop&quot;&gt;lo&lt;span style=&quot;margin-right:0.01389em;&quot;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.427em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;π&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathbf&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;π&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathbf&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.05278em;&quot;&gt;β&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.30110799999999993em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.6985050000000004em;&quot;&gt;&lt;span style=&quot;top:-1.872331em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.050005em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop op-symbol large-op&quot;&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-4.347113em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.05em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;p&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.277669em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.05278em;&quot;&gt;β&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.31166399999999994em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;i&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;In the heart of this equation we have a linear model; even if the predicted probability is not linear in the predictors, it is restricted to the logistic curve:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d52b76e546b3958a30c4da78ee92bd94/bd193/logistic_function-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 432px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA30lEQVQoz4WS2w6EMAhE+/8f6asPPqj1fmX3kEzTmLVLMlFamDJAsK/N82z7vtt5nnYcRxHEXNfl8cuy2Lqu/t22zc8DhNM0+cV93374Bu4hHIbBYow2jqP/A4rizgk54AWMpDeQ0Pd9ejw3fBSEpmn8NYJLZAAykjBVLOA7YVVVVtd1CnySECgVVCayV0JV+CtAsugP/Sq1JBHitG2bevjsCwOjuhKZqnZCHMbOGgBkaYoAwn/TB1o5rxACJHVd51+qRWa+Sto5JXOvvcz9IHl5zyRPA8EgQ0Een5u25AM+oBOiEDi/tgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;center&quot;
        title=&quot;&quot;
        src=&quot;/static/d52b76e546b3958a30c4da78ee92bd94/bd193/logistic_function-1.png&quot;
        srcset=&quot;/static/d52b76e546b3958a30c4da78ee92bd94/4b199/logistic_function-1.png 148w,
/static/d52b76e546b3958a30c4da78ee92bd94/d3891/logistic_function-1.png 295w,
/static/d52b76e546b3958a30c4da78ee92bd94/bd193/logistic_function-1.png 432w&quot;
        sizes=&quot;(max-width: 432px) 100vw, 432px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
     &lt;/p&gt;
&lt;p&gt;No method is perfect: Logistic regression makes some crude assumptions on the data, this might be good in the face of few datapoints, but too restrictive if we have a lot of data. On the other hand nearest neighbor methods, does not make many assumptions and can capture non-linear relationships between predictor and response, but might fail if there are not enough similar patients or if we are at the boundary of the data. The last point is critical: Say that the risk of diabetes increases with BMI, and we have a patient with very high BMI, most similar patients will tend to have a lower BMI, and we will have a tendency to underestimate the diabetes-risk.&lt;/p&gt;
&lt;p&gt;Locally weighted logistic regression tries to marry the two methods. The prediction in a point, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, is based on a logistic regression model, but with a weighted dataset, that emphasizes datapoints near &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;h4&gt;Fitting&lt;/h4&gt;
&lt;p&gt;Locally weighted logistic regression models can be fitted using &lt;code class=&quot;language-text&quot;&gt;glm&lt;/code&gt; just as usual logistic regression. We need to set the weights using the &lt;code class=&quot;language-text&quot;&gt;weight&lt;/code&gt; argument in &lt;code class=&quot;language-text&quot;&gt;glm&lt;/code&gt;. The documentation states that:&lt;/p&gt;
&lt;blockquote&gt;
For a binomial GLM prior weights are used to give the number of trials when the response is the proportion of successes.
&lt;/blockquote&gt;
&lt;p&gt;The method does produce the correct estimates even if we provide non-integer weights, we will get a warning though and one should be cautious of scaling the weights correctly if you want confidence intervals(more below). To get rid of the of the warning use &lt;code class=&quot;language-text&quot;&gt;family=quasibinomial(&amp;#39;logit&amp;#39;)&lt;/code&gt; instead of &lt;code class=&quot;language-text&quot;&gt;family=binomial(&amp;#39;logit&amp;#39;)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;We look at a dataset from the &lt;em&gt;National Healthh and Nutrition Examination Survey&lt;/em&gt;.
The data can be found &lt;a href=&quot;http://www.umass.edu/statdata/statdata/data/&quot;&gt;here&lt;/a&gt;.
We will try to estimate risk of being &lt;code class=&quot;language-text&quot;&gt;obese&lt;/code&gt; using &lt;code class=&quot;language-text&quot;&gt;seated&lt;/code&gt; the number of minutes of seated activity pr. week.
Notice that &lt;code class=&quot;language-text&quot;&gt;seated&lt;/code&gt; is reported rather than measured thus taking only values that are multiples of 30 in the higher range.
This is less than ideal, but I went with this dataset anyway because it provides a good example of a non-monotone relation between predictor and response.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;library&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
nhanes &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; read.table&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;nhanes.dat&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; na.strings&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
  do&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;.&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;complete.cases&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;.&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

names&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nhanes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;seated&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;obese&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;First we fit a simple logistic regression model &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;lrfit &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obese &lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; seated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
             data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nhanes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
             family &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; binomial&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;logit&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Obtain estimates&lt;/span&gt;
newdata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data.frame&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; seated &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; seq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;840&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
pred &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lrfit&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; newdata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;link&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; se.fit &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; T&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Calculate confidence intervals&lt;/span&gt;
upr &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; lrfit&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;family&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;linkinv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;fit &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.96&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;se.fit&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
lwr &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; lrfit&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;family&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;linkinv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;fit &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.96&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;se.fit&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
fit &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; lrfit&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;family&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;linkinv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;fit &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

plot_df &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; seated &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; seq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;840&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                       p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; fit&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                       upr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; upr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                       lwr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lwr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                       lambda &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;Inf&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We get the following estimates of the probability. &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;library&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
ggplot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plot_df&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; seated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ymin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lwr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ymax &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; upr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; geom_ribbon&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;alpha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; theme_bw&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/79b2744184a3ae5de4e4828bc2239a6e/95632/simpleLogisticPlot-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 576px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABUklEQVQ4y51Tya6CQBDk///EaCRq8EC8mJhgPAgXDi5xOQh68KKyo/VSbfplJBx8r5MGipmpqd6s1+uFuq7/7VVVgfZ8PgVbeZ4LIHHzrd62rk67XC44nU6CrSRJPg5/40pEOx6PGI1GWK/Xgi2V+xdCWlEU8H0fw+EQvV4Pm83mTZhl2VeKTFVxHGMymQiRbdvy3m63b8I0Tb8mejweWCwW6HQ66Ha7GI/H8DxP1FEYC2S1hav/1JjnIAjQ7/dF0Xw+x36/x/1+h2llWcLio0lAI2b1qMhxHEynU+x2O1HS3KfnhZBhmDecz2csl0u4rit5CsMQt9vtg8RsGzMyIeSG6/WK2WwmFRsMBvIdRdGH6rb+bFZeCNndh8NBErxarSRfTRIT6+Em2S8hJ4Vh6whpNdlnvIyExNys48ZLTazrUmXNidng5jhq37FAarrehn8ArN7pXKNTbCAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;center&quot;
        title=&quot;&quot;
        src=&quot;/static/79b2744184a3ae5de4e4828bc2239a6e/95632/simpleLogisticPlot-1.png&quot;
        srcset=&quot;/static/79b2744184a3ae5de4e4828bc2239a6e/9d04d/simpleLogisticPlot-1.png 148w,
/static/79b2744184a3ae5de4e4828bc2239a6e/f1dcb/simpleLogisticPlot-1.png 295w,
/static/79b2744184a3ae5de4e4828bc2239a6e/95632/simpleLogisticPlot-1.png 576w&quot;
        sizes=&quot;(max-width: 576px) 100vw, 576px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
     &lt;/p&gt;
&lt;p&gt;We now turn to local logistic regression. When we fit the local logistic regression model we have to decide a &lt;a href=&quot;http://en.wikipedia.org/wiki/Kernel_%28statistics%29&quot;&gt;kernel&lt;/a&gt;, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;K&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.68333em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.68333em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, and a kernelwidth, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. The weight we put on each datapoint when we estimate &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;π&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\pi(x)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.03588em;&quot;&gt;π&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; is a function of the distance, &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;d&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, from &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;x&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; to the datapoint.&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;;&lt;/mo&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo fence=&quot;true&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;w(d;\lambda) = K\left(\frac{d}{\lambda}\right)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.45em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:2.40003em;vertical-align:-0.95003em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;&lt;span class=&quot;mopen delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size3&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.37144em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;d&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size3&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;We will use the Epanechnikov kernel given by&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;−&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo fence=&quot;true&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∣&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;K(x) = \frac{3}{4}\left( 1-x^2 \right)\mathbb{1}(|x| &amp;lt; 1)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.32144em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:2.00744em;vertical-align:-0.686em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.32144em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;&lt;span class=&quot;mopen delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size1&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mbin&quot;&gt;−&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2222222222222222em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.8641079999999999em;&quot;&gt;&lt;span style=&quot;top:-3.113em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size1&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∣&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e7cba99660cf9a8a4a30be050bfb8906/bd193/epanechnikov-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 432px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA5ElEQVQoz32Syw6FIAxE+f+fdO3Kt6io9R6SIdVrbNIApTMdSoP97DxPSynZvu83J3Ych23bZjFGW5Yln595PjdAxoaA9nJsXVfrus7GcbS+720Yhr88ziINgEhEhdSKjATIiMnmec7kmMi8qMBTUEEFXYoAMuICqxAqwUjAjbCqKqvr+lYNoxBqPEhOEV7lY4VwmqYM9gq5fAKe6sHxSb5NpYf0hIPsS50IVVSmScm/TCV6woq3bVvG4M31GnoppeALoYIk8BFU9vPGHsVMgo+BaZom47jPc2gv5sfEj4t+/CvvApFkFA7RsvBLAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;center&quot;
        title=&quot;&quot;
        src=&quot;/static/e7cba99660cf9a8a4a30be050bfb8906/bd193/epanechnikov-1.png&quot;
        srcset=&quot;/static/e7cba99660cf9a8a4a30be050bfb8906/4b199/epanechnikov-1.png 148w,
/static/e7cba99660cf9a8a4a30be050bfb8906/d3891/epanechnikov-1.png 295w,
/static/e7cba99660cf9a8a4a30be050bfb8906/bd193/epanechnikov-1.png 432w&quot;
        sizes=&quot;(max-width: 432px) 100vw, 432px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Any kernel can be used, but it is advantagous to use a kernel, that dies off completely(i.e. puts weight 0 on some observation) as this reduces the computational cost of evaluating the model. &lt;/p&gt;
&lt;p&gt;And finally some action: We fit a local logistic regression model using &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda = 200&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. We chose this value of &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; using 5 repeats of 10-fold cross validation and using AUC as selection criteria. This was aided by the &lt;code class=&quot;language-text&quot;&gt;caret&lt;/code&gt; package and the use of custom models. The code is ugly and reflects that I’m still a novice using &lt;code class=&quot;language-text&quot;&gt;caret&lt;/code&gt; so I will spare you.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;kernel_width &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
loclog &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; sapply&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;seq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;840&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# Calculate weights and remove observations falling outside kernel&lt;/span&gt;
  dat &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; nhanes &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt; 
    filter&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; abs&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;seated &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; kernel_width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token percent-operator operator&quot;&gt;%&gt;%&lt;/span&gt;
    mutate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; weight &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pmax&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;seated&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;kernel_width&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;# Fit model locally&lt;/span&gt;
  lrfit &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obese &lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; seated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
               data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dat&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
               family &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; quasibinomial&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;logit&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
               weights &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dat&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;weight &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;# Predict locally&lt;/span&gt;
  newdata &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; seated &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  pred &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lrfit&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; newdata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;link&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; se.fit &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; T&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  
  upr &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;fit &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.96&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;se.fit&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  lwr &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;fit &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.96&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;se.fit&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  fit &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; pred&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;fit
  
  lrfit&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;family&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;linkinv&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lwr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fit&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; upr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

df &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; data.frame&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;seated &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; seq&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;840&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                      p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; loclog&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                      lwr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; loclog&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                      upr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; loclog&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
                      lambda &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;ggplot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;df&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; seated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ymin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lwr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ymax &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; upr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
  geom_ribbon&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;alpha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; theme_bw&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/29b45d4d69f0bea69b81acf6dca7a801/95632/localLogisticPlot-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 576px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABcElEQVQ4y41TTa+CMBDs//8hSGLUiBeNJhw8oBc8SPSgAvEAihpCQCN+7cusKSnI871NlrJtZzrb3Yrn80mPx+Nffr/f2aUBC8Oc3CMwCX+9XoXXxRIMOx6PNJvNaDqdUhRFPId9t9uNRJqmJXDVVaLL5ULz+ZwMw6Bms0mdTocGg0FByoSQ+xdRnue0XC6ZqNFo8DgcDqnb7bL3+33a7XaME3UpwmFZlnFaALVaLRqPx+R5HsVxTNfrldW2221Wul6vGSPO53OtqsViwUpM0+R/kNfZZDIhXdfJdd23QpykEp1OJxqNRpzS4XAogdUCSUySJKx+tVq9FeITBAHLtyyLU3Ac54Pk2z3btl1gBCqz3W5J0zTq9XqFqm9EVULf97loTIiFzWbDKaItYGjQb0TV4oVhWE4ZVUM/qt0vVUrQb7F8Kbh7jPxSkDYWMYEYlZfPCTEqjD0yxno1ls9SyBPUk2Xl1ZT2+32hqtoZavwD8mXhXqwq2QgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;center&quot;
        title=&quot;&quot;
        src=&quot;/static/29b45d4d69f0bea69b81acf6dca7a801/95632/localLogisticPlot-1.png&quot;
        srcset=&quot;/static/29b45d4d69f0bea69b81acf6dca7a801/9d04d/localLogisticPlot-1.png 148w,
/static/29b45d4d69f0bea69b81acf6dca7a801/f1dcb/localLogisticPlot-1.png 295w,
/static/29b45d4d69f0bea69b81acf6dca7a801/95632/localLogisticPlot-1.png 576w&quot;
        sizes=&quot;(max-width: 576px) 100vw, 576px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
     &lt;/p&gt;
&lt;h4&gt;Confidence intervals&lt;/h4&gt;
&lt;p&gt;You may skip the next part, as it is a bit technical. The take-home message is:
&lt;em&gt;In order to obtain correct confidence intervals(CIs), multiply you kernel by a constant such that &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;K(0)=1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;In &lt;em&gt;The Elements of Statistical Learning&lt;/em&gt; there is a point about getting confidence intervals(CI) for you estimates for “free”.
However in order to obtain correct CI’s you need to be careful with the weights you use.
For instance in logistic regression multiplying all weights by a constant factor &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;c&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; will not influence your estimate,
essentially you are just multiplying the log likelihood function by the same constant.
But the CI’s gets more narrow the higher the weights, again this is because the observed Fisher information increases with the weights. &lt;/p&gt;
&lt;p&gt;So we have to find the correct scaling &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;c_\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.58056em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; for a given &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;.
Our weights are&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;;&lt;/mo&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo fence=&quot;true&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;w(x; \lambda) = K\left(\frac{x}{\lambda}\right)c_\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1.8359999999999999em;vertical-align:-0.686em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;&lt;span class=&quot;mopen delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size2&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.10756em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size2&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;Two simple assumptions can help us find the correct weights.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Rescaling predictors &lt;em&gt;and&lt;/em&gt; &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; with a constant &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\alpha&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.43056em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, should leave the weights unchanged&lt;/li&gt;
&lt;li&gt;As the &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∞&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda \rightarrow \infty&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;→&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;∞&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; we approach regular logistic regression, and thus all weights should be 1. &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In mathematical terms.&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;;&lt;/mo&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;;&lt;/mo&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;w(x; \lambda) = w(\alpha x; \alpha \lambda)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mi&gt;lim&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∞&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo separator=&quot;true&quot;&gt;,&lt;/mo&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lim_{\lambda \rightarrow \infty} w(x, \lambda) = 1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1.5021079999999998em;vertical-align:-0.7521079999999999em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-2.047892em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;→&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;∞&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.7em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop&quot;&gt;lim&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7521079999999999em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.02691em;&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;From the first equation we easily get &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;α&lt;/mi&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;c_\lambda = c_{\alpha\lambda} =  c&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.43056em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.58056em;vertical-align:-0.15em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.33610799999999996em;&quot;&gt;&lt;span style=&quot;top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot; style=&quot;margin-right:0.0037em;&quot;&gt;α&lt;/span&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.15em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;, that is the constant we have to multiply the weights by, does not change with &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. From the second equation we get&lt;/p&gt;
&lt;span class=&quot;katex-display&quot;&gt;&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mtable&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mstyle scriptlevel=&quot;0&quot; displaystyle=&quot;true&quot;&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mi&gt;lim&lt;/mi&gt;&lt;mo&gt;⁡&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;mo&gt;→&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;∞&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mrow&gt;&lt;mo fence=&quot;true&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo fence=&quot;true&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;0.277778em&quot;&gt;&lt;/mspace&gt;&lt;mo&gt;⟹&lt;/mo&gt;&lt;mspace width=&quot;0.277778em&quot;&gt;&lt;/mspace&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;.&lt;/mi&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\begin{aligned}
\lim_{\lambda \rightarrow \infty}K\left(\frac{x}{\lambda}\right)c = K(0)c = 1 \implies
c = \frac{1}{K(0)}.
\end{aligned}&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:1.52872em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:2.55744em;vertical-align:-1.02872em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mtable&quot;&gt;&lt;span class=&quot;col-align-r&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.52872em;&quot;&gt;&lt;span style=&quot;top:-3.5287200000000003em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3.32144em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mop op-limits&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;span style=&quot;top:-2.047892em;margin-left:0em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mathit mtight&quot;&gt;λ&lt;/span&gt;&lt;span class=&quot;mrel mtight&quot;&gt;→&lt;/span&gt;&lt;span class=&quot;mord mtight&quot;&gt;∞&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-2.7em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:2.7em;&quot;&gt;&lt;/span&gt;&lt;span&gt;&lt;span class=&quot;mop&quot;&gt;lim&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.7521079999999999em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;minner&quot;&gt;&lt;span class=&quot;mopen delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size2&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.10756em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;x&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.686em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose delimcenter&quot; style=&quot;top:0em;&quot;&gt;&lt;span class=&quot;delimsizing size2&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.16666666666666666em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace thickspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;⟹&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace thickspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord mathit&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mopen nulldelimiter&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mfrac&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.32144em;&quot;&gt;&lt;span style=&quot;top:-2.314em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.15em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;stretchy&quot; style=&quot;height:0.2em;&quot;&gt;&lt;svg width=&apos;400em&apos; height=&apos;0.2em&apos; viewBox=&apos;0 0 400000 200&apos; preserveAspectRatio=&apos;xMinYMin slice&apos;&gt;&lt;path d=&apos;M0 80H400000 v40H0z M0 80H400000 v40H0z&apos;/&gt;&lt;/svg&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;top:-3.677em;&quot;&gt;&lt;span class=&quot;pstrut&quot; style=&quot;height:3em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:0.936em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose nulldelimiter&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot; style=&quot;height:1.02872em;&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;p&gt;That is just multiply you kernel by a constant such the &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;K(0) = 1&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.75em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:1em;vertical-align:-0.25em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot; style=&quot;margin-right:0.07153em;&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mord rule&quot; style=&quot;margin-right:0.2777777777777778em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Here is a plot of fit of confidence intervals for different values of &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;. Notice how the width of the confidence interval approaches that of global logistic regression for large &lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;λ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&quot;application/x-tex&quot;&gt;\lambda&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&quot;katex-html&quot; aria-hidden=&quot;true&quot;&gt;&lt;span class=&quot;strut&quot; style=&quot;height:0.69444em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;strut bottom&quot; style=&quot;height:0.69444em;vertical-align:0em;&quot;&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathit&quot;&gt;λ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;‘s.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;r&quot;&gt;&lt;pre class=&quot;language-r&quot;&gt;&lt;code class=&quot;language-r&quot;&gt;plot_df&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;lambda &lt;span class=&quot;token operator&quot;&gt;&amp;lt;-&lt;/span&gt; as.factor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plot_df&lt;span class=&quot;token operator&quot;&gt;$&lt;/span&gt;lambda&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
ggplot&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plot_df&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; seated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lambda&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ymin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lwr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ymax &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; upr&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; geom_line&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
  geom_ribbon&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;alpha &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; lambda&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; theme_bw&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/8873e9ec04cb6a8c98ec8d82db984d02/95632/CIsPlot-1.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 576px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 62.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACK0lEQVQ4y1VTa2/iMBDk//+l+3SVKlVV+6W66lqggTzJA8jLju3YztzaCTkwGmWZrGY3u+MNYwyn0wlZliEKQ+RFgYKQ57lHFEVI04Ti/7zLPR6POOUnzxlj4M40TdhIKdG2LbquQ8cH9OcK7fWC5sZ1DD0bfNw0N64DJ34gnvf8UXDgHLdjL2fwl2eo6Ihp4YwWOGdvyIJfGEe55pbijKf8Bcc+hkt2Yl5QDwPG6xXDzw5iv4UqcrC/n5BDi7YOUSZvYG2KInnFtfoB0xJflx329QEJy/CcvcJM012H1JUkMav1Wl2WJYr4HaxLV06LFnH5jc96B2XUylfygopmnNGs3dmMSmEkMQdF8xzHkbrjEARjJyglCco/e95BU57RBnLhR2NxST9RZsEs2DSN39jhcMD3douYKiVxjDCM/Ia3xAVBgCyNV97l73d7hEmE4pTj43zAV7oIuo78lpY5SIq7pVNrHTcjrjSuLS1lsrBuAW4M9Qi9ZTgmA6LkMgsKIXzASSAgqzyR335TVVjjhRqmscsU/oQKLZtnZxR9cjpAfHQYcypeS8h21tnIRSggjzWuM5pJS8+qkYhKhbJWkKP14uMgIUIGmXASUXB92uW3bvnqbgoZ+uHQi7pX0OaOIqhBwXLzmEpjmUe2CLqtaerIXUFOJnfo+h5S0icJujn9zLv3PUEosebdeGvvOjT0RzmrkOg9XCFnC7fpqqr8krxNllwX33KnO2P/A8O95vVLlRiAAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;center&quot;
        title=&quot;&quot;
        src=&quot;/static/8873e9ec04cb6a8c98ec8d82db984d02/95632/CIsPlot-1.png&quot;
        srcset=&quot;/static/8873e9ec04cb6a8c98ec8d82db984d02/9d04d/CIsPlot-1.png 148w,
/static/8873e9ec04cb6a8c98ec8d82db984d02/f1dcb/CIsPlot-1.png 295w,
/static/8873e9ec04cb6a8c98ec8d82db984d02/95632/CIsPlot-1.png 576w&quot;
        sizes=&quot;(max-width: 576px) 100vw, 576px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
     &lt;/p&gt;
&lt;h4&gt;End notes&lt;/h4&gt;
&lt;p&gt;Even if local logistic regression is not an optimal choice for a predictive model in your setting, it is still a useful tool to visualize the relationship between a predictor and a binary outcome.
Logistic regression provides a method to control the bias, that nearest neighbor methods may exhibit near the boundaries.
For a more lengthy discussion see chapter 6 in &lt;a href=&quot;http://statweb.stanford.edu/~tibs/ElemStatLearn/&quot;&gt;&lt;em&gt;The Elements of Statistical Learning&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;</content:encoded></item></channel></rss>