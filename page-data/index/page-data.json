{
    "componentChunkName": "component---src-pages-index-js",
    "path": "/",
    "result": {"data":{"site":{"siteMetadata":{"title":"TobiasMadsen.com","description":"A blog about statistics, software development and mathematics"}},"allMarkdownRemark":{"edges":[{"node":{"id":"7ee7709b-9bb1-595e-8a3f-b278925a8ce5","excerpt":"In Robert Shiller’s paper Do stock prices move too much to be justified\nby subsequent changes in dividends? ask the question whether the…","html":"<p>In Robert Shiller’s paper <a href=\"https://ms.mcmaster.ca/~grasselli/Shiller81.pdf\">Do stock prices move too much to be justified\nby subsequent changes in dividends?</a> ask the question whether the\nfinancial markets really are as rational and efficient as they are made\nout to be. Shiller first defines a measure of “intrinsic” stock value\ndefined by future dividends. He then observes that the measure of\nintrinsic value of the aggregate stock market is quite stable over time.\nIn other words even the most important events don’t have a large impact\non the stock market value. In contrast the price of the aggregate stock\nmarket fluctuates heavily seemingly (over)reacting to any news that\ncould have a bearing on future performance. Of course future dividends\nare not knowable and the above observation could be reasonable looking\nat a short time frame, but over a long timeframe price is actually\nexpected to fluctuate <em>less</em> than value.</p>\n<p>In this blog post I will reproduce the result from the Shiller paper.\nFirst, download the data and do a few data processing steps:</p>\n<ol>\n<li>Convert prices to <code class=\"language-text\">numeric</code></li>\n<li>Use only one value per year from January</li>\n<li>Extract a year variable from <code class=\"language-text\">Date</code></li>\n</ol>\n<!-- -->\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">json_file &lt;- 'https://datahub.io/core/s-and-p-500/datapackage.json'\njson_data &lt;- fromJSON(paste(readLines(json_file), collapse=\"\"))\n\nconn &lt;- url(json_data$resources$path[2])\nsp &lt;- read_csv(conn)\n\nsp &lt;- sp %>%\n  filter(months(Date) == \"January\") %>%\n  mutate(year = lubridate::year(Date)) %>%\n  mutate(`Real Price` = as.numeric(`Real Price`))</code></pre></div>\n<p>The real price and the real dividend series are denoted by\n<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">P_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> and <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">D_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span> respectively in the paper. These\nseries grow exponentially,\n<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mi>t</mi></msub><mo>=</mo><msub><mi>D</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><msup><mi>λ</mi><mrow><mi>t</mi><mo>−</mo><mi>T</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">d_t = D_t / \\lambda^{t-T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913309999999998em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span></span> and\n<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><msub><mi>P</mi><mi>t</mi></msub><mi mathvariant=\"normal\">/</mi><msup><mi>λ</mi><mrow><mi>t</mi><mo>−</mo><mi>T</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">p_t = P_t / \\lambda^{t-T}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913309999999998em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span></span></span>  denote\ntheir detrended counterparts. To estimate the exponential growth rate we\ndo a simple linear regression of the logged real price,\n<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><msub><mi>P</mi><mi>t</mi></msub><mo>=</mo><mi>λ</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">\\log{P_t} = \\lambda t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\">t</span></span></span></span></span></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(lambda &lt;- lm(formula = log(`Real Price`) ~ year, data = sp)$coef['year'])\n\n##       year \n## 0.01830791</code></pre></div>\n<p>Using data from 1871-2018 instead of 1871-1979 as in the original paper,\nwe get a slightly higher growth rate <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><mtext> </mtext><mi>λ</mi><mtext> </mtext><mo>=</mo><mtext> </mtext><mn>0.0183</mn></mrow><annotation encoding=\"application/x-tex\">\\log \\lambda = 0.0183</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"> </span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"> </span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\"> 0.0183</span></span></span></span></span> compared to <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">.</mi><mn>0148</mn></mrow><annotation encoding=\"application/x-tex\">.0148</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">.0148</span></span></span></span></span>\n(see table 2 in the original paper).</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sp &lt;- sp %>% \n  mutate(Dividend_detrended = `Real Dividend` / exp((year-1871) * lambda)) %>%\n  mutate(SP500_detrended    = `Real Price`    / exp((year-1871) * lambda))</code></pre></div>\n<p>The discount rate can be estimated from data as</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>r</mi><mo>ˉ</mo></mover><mo>=</mo><mfrac><mrow><mi mathvariant=\"double-struck\">E</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"double-struck\">E</mi><mi>p</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\bar{r} = \\frac{\\mathbb{E}d}{\\mathbb{E}p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.56778em;vertical-align:0em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.56778em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.25188em;vertical-align:-0.8804400000000001em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.37144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">E</span><span class=\"mord mathnormal\">p</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">E</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804400000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></div>\n<p>The estimate is intuitively appealing, since this solves equation 3</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>p</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant=\"normal\">∞</mi></munderover><msup><mrow><mo fence=\"true\">(</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mover accent=\"true\"><mi>r</mi><mo>ˉ</mo></mover></mrow></mfrac><mo fence=\"true\">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">p = \\sum_{k=0}^\\infty \\left(\\frac{1}{1+\\bar{r}}\\right)^{k+1} d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.991121em;vertical-align:-1.302113em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.8478869999999998em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.0500049999999996em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.300005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">∞</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.302113em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.32144em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.56778em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.19444em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693300000000001em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.689008em;\"><span style=\"top:-3.9029000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span></span></div>\n<p>with stable dividends. However, as the “discount rate” defined here is\nestimated from data, it also includes a risk-premium. Due to variance in\nthe dividends stocks should be cheaper than an asset with fixed known\nreturns.</p>\n<p>The estimate of <em>r̄</em> determines how much the ex-post rational price is\nsmoothed over the years: At one extreme if there is a very high discount\nrate, meaning only the next dividend matters, variance in the ex-post\nrational price will be as high as the variance of dividends, in the\nother extreme if the discount rate is very low there will be almost no\nvariance in the ex-post rational price since it is the sum of dividends\nover many years. Since the point of the paper is to show that the\nrational price has much smaller variation than the observed price, the\nestimated discount rate is of central importance.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(discount_rate &lt;- mean(sp$Dividend_detrended) / mean(sp$SP500_detrended))\n\n## [1] 0.03931119</code></pre></div>\n<p>Using the estimated discount rate we can compute the ex-post,\ni.e. after-the-fact, rational stock price using eq. (4):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># Compute ex post rational stock price recursively\nsp$ex_post_price &lt;- mean(sp$SP500_detrended, na.rm = T)\n\nfor (t in (nrow(sp)-1):1 ) {\n  gamma &lt;- 1 / (1 + discount_rate)\n  # See Stiglitz Chapter 9: Appendix B: Calculating Present Discounted Value p. 209\n  sp$ex_post_price[t] = gamma * (sp$ex_post_price[t+1] + sp$Dividend_detrended[t]) \n}</code></pre></div>\n<p>We are now ready to reproduce the central figure 1 from the paper:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sp %>% \n  ggplot() +\n  geom_line(aes(x = year, y = SP500_detrended), linetype = \"solid\") +\n  geom_line(aes(x = year, y = ex_post_price ), linetype = \"longdash\") +\n  ylab(\"Index\") +\n  xlab(\"Year\") +\n  theme_bw()</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/87c2eda4ad6a57563dc95813650dae9b/4ad3a/unnamed-chunk-1-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.45569620253164%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABKUlEQVQ4y5WT2aqFMAxF+/+/6YAKzvPYw8phS/EeH26g1Dbtyk5S3bZtft93fxzHv8d5nn5ZFg+Db2aH47ouL+P7uX7uh9/DMJggDLiDrAPhCC++DWyeZwMhbF1X76A/oazfAr0Bmf8AZXVdm/OXymfKwNq29V3XfVMGiHMcRwNRkyiKzImpxgKogTLOFUXh1VwHQI44jn2apj5JEoNjRA6BrBlSyr2qqixlMnWKiEKc0zSZEyD7fd/fJWFmTYrKDGXcQxjnnd5P0zQ+NA6wpxlTUL07BgIk4gYSiSaEndUzQFGe56YIZWFHy7K0gNxTve8uPzuKk8sAsyyzugGSUkrCHD5+a8qvdxj+BXpnAJjlB6Y/RHsGBBb+m2wqfQVjAFDtdFb11z7AD5Js/Za4zBSAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"unnamed chunk 1 1\"\n        title=\"unnamed chunk 1 1\"\n        src=\"/static/87c2eda4ad6a57563dc95813650dae9b/f058b/unnamed-chunk-1-1.png\"\n        srcset=\"/static/87c2eda4ad6a57563dc95813650dae9b/c26ae/unnamed-chunk-1-1.png 158w,\n/static/87c2eda4ad6a57563dc95813650dae9b/6bdcf/unnamed-chunk-1-1.png 315w,\n/static/87c2eda4ad6a57563dc95813650dae9b/f058b/unnamed-chunk-1-1.png 630w,\n/static/87c2eda4ad6a57563dc95813650dae9b/40601/unnamed-chunk-1-1.png 945w,\n/static/87c2eda4ad6a57563dc95813650dae9b/4ad3a/unnamed-chunk-1-1.png 1152w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>We can compare this with the original figure from Shiller’s paper:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/884a98e36c953c5681a297320aa26a81/e8e04/shiller_fig_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.64556962025317%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABy0lEQVQ4y6WT2cpiMRCEz/u/gO/gnbciguCF4oIruOK+7/tuD19D548OzDBMQ0hOUqfSVd0J7ve7lEol6ff7slwu5fl8CvF+v8UPvm3vT+uAxePxkMPh8E8/fl9qa0e43W7/CvbXr9dL52azKeVy2e0FkNVqNVmv1+4HA18uFzmfzw48Go1+w3S7XQmHw4rVDDmEbLfbfWSAl9Fo1JHwnU6nPzD8VygUFEMNnGTidDo5WQAXi4XenEwmxWzJ5/Mfcvf7vfR6PV1Pp9MfQiOYzWYSiUR0JBIJJctms0qG9Gq1KpPJxF2MXEg5t32V3G63lRQf4vG43tZqteR6vUq9XtdBJrlcTi8B2+l0JBaLyXA41GQojhJa+niAJEj84Bzy4/EoqVRKQqGQZopF4/FYMWQPOT4HZjipNxoNodGNyHoPK8hiMBhotplMRuf5fO6wKEB6YF6sVquPBvYbGTlgLPCX12Wvyg8lRI7fNt+EeOb3I0TfL8sUOckG+N9QQp4dlcUDisIgI2YqTwGY7Yxxu910D8+xq1Kp/HhItTAaEP1Ee0CC6bxTCkZR6ALWm81GMdiEHcViUUmV0H9q5gkHFr7x1gGE314kYpJ/AQhBy8EojUSqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 1 from Shiller: Do stock prices move too much to be justified\nby subsequent changes in dividends\"\n        title=\"Figure 1 from Shiller: Do stock prices move too much to be justified\nby subsequent changes in dividends\"\n        src=\"/static/884a98e36c953c5681a297320aa26a81/f058b/shiller_fig_1.png\"\n        srcset=\"/static/884a98e36c953c5681a297320aa26a81/c26ae/shiller_fig_1.png 158w,\n/static/884a98e36c953c5681a297320aa26a81/6bdcf/shiller_fig_1.png 315w,\n/static/884a98e36c953c5681a297320aa26a81/f058b/shiller_fig_1.png 630w,\n/static/884a98e36c953c5681a297320aa26a81/40601/shiller_fig_1.png 945w,\n/static/884a98e36c953c5681a297320aa26a81/78612/shiller_fig_1.png 1260w,\n/static/884a98e36c953c5681a297320aa26a81/e8e04/shiller_fig_1.png 1270w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>The most striking difference is that using four decades more of data we\narrive at a higher growth rate, meaning that the peak in 1930 and 1970\nappear smaller. The striking conclusion of the original paper remains\nunchanged, the ex-post price series has much smaller variance than the\nobserved price.</p>","frontmatter":{"title":"Shiller - Do stock prices move too much?","subtitle":null}}}]}},"pageContext":{}},
    "staticQueryHashes": []}